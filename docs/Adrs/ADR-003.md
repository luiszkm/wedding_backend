ADR-003: Criação do Contexto de Comunicação para o Módulo de Comunicados
Status: Aceito

Data: 2025-08-06

1. Contexto (Context)
Atualmente, a plataforma permite que os anfitriões gerenciem a lista de convidados, a lista de presentes e a aparência da página do evento. No entanto, não existe um canal de comunicação oficial e centralizado dentro do sistema para que os anfitriões enviem atualizações, lembretes ou comunicados importantes a todos os convidados (ex: "Lembrete: a cerimônia começa às 19h", "Atenção: o estacionamento recomendado é o da rua X").

Esta lacuna força os anfitriões a usarem canais externos (como grupos de WhatsApp), fragmentando a comunicação e diminuindo o papel da plataforma como o hub central do evento.

A decisão arquitetural necessária é como introduzir esta funcionalidade de forma que ela agregue valor sem aumentar a complexidade ou o acoplamento dos contextos já existentes (Gestão de Convidados, Lista de Presentes, etc.).

2. Decisão (Decision)
Decidimos projetar e implementar a funcionalidade de "Comunicados" como um novo e independente Contexto Delimitado: o Contexto de Comunicação.

Esta decisão se materializa no seguinte plano de implementação:

Novo Contexto Delimitado: A lógica, os dados e as regras de negócio para comunicados serão isolados em seu próprio módulo de código, garantindo baixo acoplamento com o restante do sistema. Sua única responsabilidade será gerenciar os comunicados de um evento.

Novo Esquema de Banco de Dados: Será criada uma nova tabela para persistir os dados dos comunicados.

SQL

CREATE TABLE comunicados (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    id_evento UUID NOT NULL,
    titulo VARCHAR(255) NOT NULL,
    mensagem TEXT NOT NULL,
    data_publicacao TIMESTAMP WITH TIME ZONE DEFAULT timezone('America/Sao_Paulo', now()),

    -- Garante a relação com o evento ao qual o comunicado pertence
    CONSTRAINT fk_evento_comunicado
        FOREIGN KEY(id_evento) 
        REFERENCES eventos(id)
        ON DELETE CASCADE
);
Novos Endpoints na API: A API será estendida para permitir a gestão e a leitura dos comunicados.

Leitura (para Convidados):

GET /eventos/{idEvento}/comunicados - Retorna uma lista de todos os comunicados publicados para um evento, ordenados pelo mais recente.

Escrita (para Anfitriões - Autenticado):

POST /eventos/{idEvento}/comunicados - Cria um novo comunicado.

PUT /comunicados/{idComunicado} - Edita um comunicado existente.

DELETE /comunicados/{idComunicado} - Remove um comunicado.

3. Consequências (Consequences)
Positivas:

Alta Coesão e Baixo Acoplamento: A principal vantagem arquitetural. A nova funcionalidade é autocontida. Ela não introduz complexidade nos outros domínios. A única dependência externa é uma chave estrangeira para a tabela eventos.

Manutenibilidade e Testabilidade: Por ser um módulo isolado, é muito mais fácil de dar manutenção, testar e evoluir no futuro sem o risco de quebrar outras partes do sistema.

Clareza de Domínio: A criação de um contexto explícito para a comunicação reforça a nossa abordagem DDD e mantém a arquitetura geral do sistema limpa e fácil de entender.

Valor de Negócio Direto: Resolve uma necessidade clara dos anfitriões, aumentando o engajamento e a utilidade da plataforma como um hub central de informações para o evento.

Negativas:

Aumento da "Superfície" do Sistema: Como qualquer nova feature, ela aumenta o número de tabelas no banco de dados e de endpoints na API. É uma complexidade adicionada, embora gerenciada e isolada.

Escopo Limitado na V1: Esta decisão se concentra em exibir os comunicados na página do evento. Ela não inclui, nesta fase, um sistema de notificações ativas (como envio de e-mails ou push notifications), que exigiria uma infraestrutura adicional (serviços de e-mail, filas, etc.) e seria uma evolução futura deste contexto.